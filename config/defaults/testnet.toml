version = 1
bundle = "testnet-rollout"
description = "Rollout configuration for promoting releases to the public testnet"
node_template = "../validator.toml"
wallet_template = "../wallet.toml"
notes = [
  "Feature gates advance from development into testnet once soak criteria are met.",
  "Release checks mirror the staged rollout guidance documented in docs/deployment/staged_rollout.md.",
]

[[stages]]
name = "development"
release_channel = "development"
change_window = "daily"
feature_gates = { pruning = true, recursive_proofs = true, reconstruction = true, consensus_enforcement = true, malachite_consensus = false, timetoke_rewards = false, witness_network = false }
release_checks = [
  "docs/deployment/staged_rollout.md#development-readiness",
  "docs/deployment/staged_rollout.md#common-preflight-checks",
]
recovery_playbook = "docs/deployment/staged_rollout.md#development-recovery"

[[stages]]
name = "testnet"
release_channel = "testnet"
change_window = "twice-weekly"
feature_gates = { pruning = true, recursive_proofs = true, reconstruction = true, consensus_enforcement = true, malachite_consensus = true, timetoke_rewards = false, witness_network = false }
release_checks = [
  "docs/deployment/staged_rollout.md#testnet-readiness",
  "docs/deployment/staged_rollout.md#common-preflight-checks",
]
recovery_playbook = "docs/deployment/staged_rollout.md#testnet-recovery"

[network.admission]
policy_path = "./data/p2p/admission_policies.json"
audit_retention_days = 30

[network.admission.signing]
enabled = false
key_path = "./secrets/admission_signing.toml"
active_key = "admission_dev"

[network.admission.signing.trust_store]
admission_dev = "0000000000000000000000000000000000000000000000000000000000000000"

[admission_reconciler]
cadence_secs = 60
drift_alert_threshold = 1
max_audit_lag_secs = 300

[network.admission.defaults.blocks]
subscribe = "tl0"
publish = "tl3"

[network.admission.defaults.votes]
subscribe = "tl0"
publish = "tl3"

[network.admission.defaults.proofs]
subscribe = "tl0"
publish = "tl1"

[network.admission.defaults.vrf_proofs]
subscribe = "tl0"
publish = "tl2"

[network.admission.defaults.snapshots]
subscribe = "tl0"
publish = "tl1"

[network.admission.defaults.meta]
subscribe = "tl0"
publish = "tl0"

[network.admission.defaults.vrf_meta]
subscribe = "tl0"
publish = "tl1"

[network.admission.defaults.witness_proofs]
subscribe = "tl0"
publish = "tl2"

[network.admission.defaults.witness_meta]
subscribe = "tl0"
publish = "tl1"
