# NOTE: Restart the wallet runtime after editing this file; live reload is not supported.
# Phase 2 policy/fee/prover settings are documented in docs/wallet_phase2_policies_prover.md.
# Phase 3 GUI settings are documented in docs/wallet_phase3_gui.md.
# Phase 4 advanced wallet flows are documented in docs/wallet_phase4_advanced.md.
# Platform defaults/live directories are documented in docs/wallet_platform_support.md.
#
# Wallet feature matrix (authoritative copy lives in README.md → "Wallet feature flags and `[wallet.*]` scopes"):
# | Cargo feature | Default | `[wallet.*]` scopes | Runtime guard when misconfigured |
# | runtime | disabled | All RPC/CLI sections | Wallet binaries omit JSON-RPC/CLI entry points until rebuilt with `--features "runtime …"` |
# | backup | enabled | `[wallet.backup]` | N/A (config-only toggle) |
# | wallet_multisig_hooks | disabled | `[wallet.multisig]` | `wallet multisig support disabled at build time` |
# | wallet_zsi | disabled | `[wallet.zsi]` | `zsi workflows disabled by configuration` |
# | wallet_rpc_mtls | disabled | `[wallet.rpc.security]`, `[wallet.security]`, `wallet.gui.security_controls_enabled` | `…requires compiling with the \`wallet_rpc_mtls\` feature…` |
# | wallet_hw | disabled | `[wallet.hw]` | `wallet hardware support disabled at build time` |
# | wallet_gui | disabled | `[wallet.gui]` | GUI binaries omitted until rebuilt with `--features wallet_gui` |
#
# Consult that matrix before enabling any of the sections below.
data_dir = "./data"

[wallet.keys]
key_path = "./keys/wallet.toml"

[wallet.rpc]
listen = "127.0.0.1:9090"
allowed_origin = null
requests_per_minute = null

# RPC security envelope. mTLS and RBAC are disabled by default; operators should
# provision certificates, keys, and role bindings before enabling. See
# docs/wallet_phase4_advanced.md#rpc-security-mtls-and-rbac for hardening steps.
[wallet.rpc.security]
mtls_required = false
role_enforcement = false
trusted_ca_dir = "./certs/ca"
certificate = "./certs/server.crt"
private_key = "./certs/server.key"
role_bindings_path = "./config/rbac.toml"

[wallet.security]
mtls_enabled = false

# [[wallet.security.ca_fingerprints]]
# fingerprint = "abcdef..."
# description = "Trusted CA"

# [[wallet.security.bindings]]
# kind = "token"
# id = "<sha256-of-token>"
# roles = ["admin"]

[wallet.auth]
enabled = false
token = null

[wallet.auth.tls]
certificate = null
private_key = null
ca_certificate = null

# Hardware signing integration. Remains disabled until an operator connects a supported
# device. Keep `fallback_to_software` true so automated jobs do not stall if the device is
# unplugged. See docs/wallet_phase4_advanced.md#hardware-integration for provisioning.
[wallet.hw]
enabled = false
transport = "hid"
device_selector = null
fallback_to_software = true

[wallet.budgets]
submit_transaction_per_minute = 120
proof_generation_per_minute = 60
pipeline_depth = 64

# GUI presentation options; see docs/wallet_phase3_gui.md for MVU architecture,
# tab flows, and telemetry.
#
# Example:
# [wallet.gui]
# theme = "dark"           # Supported: "dark", "light"
# auto_lock_secs = 300      # Inactivity lock timeout (matches security UX doc)
# clipboard_auto_clear = true
#
[wallet.gui]
theme = "dark"
auto_lock_secs = 300
clipboard_auto_clear = true

[wallet.telemetry]
crash_reports = false
endpoint = ""
machine_id_salt = ""

# Encrypted backup and recovery controls. Automatic exports stay disabled by default
# and exports land in an operator-managed directory. Rotate passphrases as described in
# docs/wallet_phase4_advanced.md#backuprecovery-formats-and-rotation.
[wallet.backup]
auto_export_enabled = false
export_dir = "./backups"
max_generations = 10
passphrase_profile = "argon2id"

# Watch-only mode mirrors chain state without local spending keys. Leave disabled unless
# the xpub file and downstream RPC consumers are configured. Guidance lives in
# docs/wallet_phase4_advanced.md#watch-only-mode.
[wallet.watch_only]
enabled = false
xpub_path = "./keys/watch_only.toml"
expose_rpc = false

# Multisig hook registration. See docs/wallet_phase4_advanced.md#multisig-hooks
# for integration guidance.
[wallet.multisig]
enabled = false

# Zero State Import (ZSI) workflows for initial data seeding. Disabled by default to
# prevent accidental replay of historical bundles. docs/wallet_phase4_advanced.md#zsi-workflows
# walks through staging and verification.
[wallet.zsi]
enabled = false
bundle_path = "./zsi"
verify_checksums = true

# Controls automatic lookback rescans and the batch size used when replaying history.
# See docs/wallet_phase2_policies_prover.md for CLI overrides.
[wallet.rescan]
auto_trigger = false
lookback_blocks = 2880
chunk_size = 64

[wallet.engine]
# Override these paths per OS as described in docs/wallet_platform_support.md when
# storing data under platform-specific application directories.
data_dir = "./data/wallet"
keystore_path = "./data/wallet/keystore.toml"
backup_path = "./data/wallet/backups"
birthday_height = null

# Spend policy knobs (gap limits, confirmation depth, dust/change budgets, lock timeout).
# Detailed guidance: docs/wallet_phase2_policies_prover.md#policy-knobs
[wallet.policy]
external_gap_limit = 20
internal_gap_limit = 20
min_confirmations = 1

# Fee estimator defaults and guardrails (min/max); see docs/wallet_phase2_policies_prover.md#fee-estimator-behaviour
[wallet.fees]
default_sats_per_vbyte = 5
min_sats_per_vbyte = 1
max_sats_per_vbyte = 200

# Wallet prover runtime; enable alongside the appropriate cargo feature. See docs/wallet_phase2_policies_prover.md#prover-configuration-mock-vs-stwo
[wallet.prover]
enabled = false
mock_fallback = true
job_timeout_secs = 300
max_witness_bytes = 16777216
max_concurrency = 1

[node]
embedded = false
gossip_endpoints = ["/ip4/127.0.0.1/tcp/7600"]

# Electrs data is stored under "./data/electrs/firewood" and "./data/electrs/index" when enabled.
[electrs]
network = "regtest"

[electrs.features]
runtime = false
tracker = false

[electrs.cache.telemetry]
enabled = false
warmup_prefix = null

[electrs.tracker]
telemetry_endpoint = "127.0.0.1:0"

[electrs.tracker.notifications]
p2p = false
topic = "/rpp/gossip/blocks/1.0.0"

[electrs.p2p]
enabled = false
metrics_endpoint = "127.0.0.1:0"
network_id = "rpp-local"
auth_token = null
gossip_topics = ["/rpp/gossip/blocks/1.0.0"]
